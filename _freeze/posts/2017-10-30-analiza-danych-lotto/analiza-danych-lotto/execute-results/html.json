{
  "hash": "b9508b78e9be25b0c8fb2eeacb43f690",
  "result": {
    "markdown": "---\ntitle: \"Analiza danych lotto\"\nauthor: \"Łukasz Wawrowski\"\ndescription: \"Jakie liczby wypadają w losowaniach Lotto najrzadziej, a jakie najczęściej? Analiza danych z 60 lat.\"\ndate: \"10/30/2017\"\nimage: \"analiza-danych-lotto_files/figure-html/freq each number-1.png\"\n---\n\n\n\n\nImpulsem do przeprowadzenia analizy danych pochodzących z losowań Lotto była konieczność przedstawienia uczniom liceum przykładu losowania prostego. Czy faktycznie każda liczba ma takie samo prawdopodobieństwo wylosowania?\n\nLotto, dawniej Toto-Lotek oraz Duży Lotek to losowanie 6 liczb z 49. Dużo ciekawych informacji na temat samej gry oraz jej historii można znaleźć na stronie [wikipedii](https://pl.wikipedia.org/wiki/Lotto_(gra_liczbowa)/). \n\nDane w formacie tekstowym można pobrać ze strony [mbnet.com.pl](http://www.mbnet.com.pl/). Po wczytaniu do R dokonałem niezbędnego przekształcenia danych.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(zoo)\n\nd <- read.table(\"http://www.mbnet.com.pl/dl.txt\", sep=\" \", dec=\".\")\nnames(d) <- c(\"obs\", \"date\", \"numbers\")\n\nd <- d %>%\n  separate(numbers, into = c(\"number1\", \"number2\", \"number3\", \"number4\", \"number5\", \"number6\")) %>%\n  separate(date, into = c(\"day\", \"month\", \"year\"), remove = F) %>%\n  mutate(date_f=as.POSIXct(strptime(date, \"%d.%m.%Y\"))) %>%\n  filter(year<2018)\n```\n:::\n\n\nDo końca 2017 roku przeprowadzono 6041 losowań. Żadna sekwencja liczb się nie powtórzyła.\n\nW pierwszej kolejności sprawdźmy ile razy dana liczba została już wylosowana. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nfreqs <- d %>%\n  select(starts_with(\"number\")) %>%\n  gather(number, value) %>%\n  mutate(value=as.numeric(value))\n\ncounts_num <- freqs %>%\n  count(value)\n  \nggplot(counts_num, aes(x=as.factor(value), n)) +\n  geom_bar(stat=\"identity\", fill=\"#FCBD10\") +\n  xlab(\"Liczba\") + ylab(\"Częstość\") + \n  theme_light() +\n  theme(axis.text.x = element_text(size = 7))\n```\n\n::: {.cell-output-display}\n![](analiza-danych-lotto_files/figure-html/freq each number-1.png){width=672}\n:::\n:::\n\n\nOkazuje się, że rozkład liczb losowanych w Lotto jest zbliżony do rozkładu jednostajnego. Najrzadziej losowana była liczba 43 - 667 razy, a najczęściej liczba 34 - 807 razy.\n\nZ kolei do przedstawienia rozkładu liczb na poszczególnych pozycjach najlepiej sprawdzi się wykres skrzypcowy - połączenie wykresu pudełkowego z rozkładem gęstości.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(freqs, aes(x=number, y=value)) + \n  geom_violin(fill=\"#FCBD10\") +\n  xlab(\"Pozycja liczby\") + ylab(\"Wylosowana liczba\") + \n  scale_x_discrete(labels = 1:6) +\n  theme_light()\n```\n\n::: {.cell-output-display}\n![](analiza-danych-lotto_files/figure-html/dist violin-1.png){width=672}\n:::\n:::\n\n\nRozkład liczb według pozycji nie zaskakuje. Na pierwszym miejscu dominują liczby z początku przedziału [1;49], a na miejscu 6 z końca tego przedziału. Niemniej jednak zdarzyły się takie losowania, jak to z 15 października 2015 roku, w którym padły liczby wyłącznie z czwartej dziesiątki: 40, 41, 42, 46, 47, 49. Z drugiej strony można przywołać 5 grudnia 1987 roku i wylosowane liczby: 1, 2, 8, 10, 11, 12.\n\nDane z losowań Lotto pokazują także jak zmieniała się liczba losowań w ciągu ostatnich 60 lat.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndraw_y <- d %>%\n  filter(year!=\"2017\") %>%\n  group_by(year) %>%\n  count()\n\nggplot(draw_y, aes(x=year, y=n, group = 1)) +\n  geom_line(color=\"#FCBD10\", size=2) +\n  geom_point(color=\"#FCBD10\", size=3) +\n  xlab(\"Rok\") + ylab(\"Liczba losowań\") + \n  theme_light() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 7))\n```\n\n::: {.cell-output-display}\n![](analiza-danych-lotto_files/figure-html/year-1.png){width=672}\n:::\n:::\n\n\nW latach 1957-1974 losowania odbywały się raz w tygodniu. Od 1975 wprowadzono drugie losowanie, a w roku 2007 trzecie.\n\nNa podstawie tych samych danych można jeszcze sprawdzić w jakie dni tygodnia odbywały się te losowania.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nweek_d <- d %>%\n  mutate(weekday=weekdays(date_f)) %>%\n  group_by(year, weekday) %>%\n  count() %>%\n  ungroup() %>%\n  mutate(weekday=ordered(weekday, \n                         levels=rev(c(\"wtorek\", \"środa\", \"czwartek\", \"sobota\", \"niedziela\")),\n                         labels=rev(c(\"wtorek\", \"środa\", \"czwartek\", \"sobota\", \"niedziela\"))))\n  \nggplot(week_d, aes(year, weekday)) + \n  geom_tile(aes(fill = n), colour = \"white\") +\n  # geom_text(aes(label = n), size=3, color = \"white\") +\n  scale_fill_gradient(\"Liczba losowań\", limits=c(0,max(week_d$n))) + \n  xlab(\"Rok\") + ylab(\"Dzień tygodnia\") +\n  theme_light() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 7),\n        axis.text.y = element_text(angle = 90, hjust = 0.5),\n        legend.position=\"bottom\")\n```\n\n::: {.cell-output-display}\n![](analiza-danych-lotto_files/figure-html/weekday-1.png){width=672}\n:::\n:::\n\n\nW pierwszych latach losowania były przeprowadzane w niedzielę. W 1984 roku przeniesiono je na sobotę, a w 1991 roku dodano losowane środowe. Od 2007 roku losowania Lotto odbywają się we wtorki, czwartki i soboty. \n\nPodobne zestawienie można utworzyć dla dni i miesięcy.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndraw_dm <- d %>%\n  group_by(month, day) %>%\n  count()\n\nggplot(draw_dm, aes(day, month)) + \n  geom_tile(aes(fill = n), colour = \"white\") +\n  geom_text(aes(label = n), size=3, color = \"white\") +\n  scale_fill_gradient(\"Liczba losowań\", limits=c(0,max(draw_dm$n))) + \n  xlab(\"Dzień\") + ylab(\"Miesiąc\") +\n  theme_light() +\n  theme(legend.position=\"bottom\")\n```\n\n::: {.cell-output-display}\n![](analiza-danych-lotto_files/figure-html/days months-1.png){width=672}\n:::\n:::\n\n\nW tym przypadku bez niespodzianek - żadna data nie była dyskryminowana. Oprócz 29 lutego - w ciągu 60 lat w ten dzień odbyły się tylko 3 losowania.\n\nSzansa trafienia \"szóstki\" w Lotto to 1 do 13 983 816 czyli bardzo mało. Z wykorzystaniem analizy częstości można wytypować najczęściej losowane \"dwójki\" czy \"trójki\", ale należy pamiętać, że wylosowanie każdej kombinacji liczb jest tak samo prawdopodobne. Ciekawie na ten temat mówi Dan Gilbert w prezentacji [Dlaczego podejmujemy złe decyzje](https://www.ted.com/talks/dan_gilbert_researches_happiness?language=pl).\n\nKod w jednym kawałku dostępny jest na [githubie](https://github.com/lwawrowski/lotto/).\n\n\n",
    "supporting": [
      "analiza-danych-lotto_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}