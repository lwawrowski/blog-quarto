<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Podstawy programowania w R - 3&nbsp; Przetwarzanie danych</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-wizualizacja.html" rel="next">
<link href="./02-struktury.html" rel="prev">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-przetwarzanie.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Przetwarzanie danych</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Podstawy programowania w R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Wprowadzenie</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Wprowadzenie do R</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-struktury.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Struktury danych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-przetwarzanie.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Przetwarzanie danych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-wizualizacja.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Wizualizacja danych</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-programowanie.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Programowanie w R</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Spis tre≈õci</h2>
   
  <ul>
  <li><a href="#wprowadzenie---pakiet-tidyverse" id="toc-wprowadzenie---pakiet-tidyverse" class="nav-link active" data-scroll-target="#wprowadzenie---pakiet-tidyverse"><span class="header-section-number">3.1</span> Wprowadzenie - pakiet tidyverse</a></li>
  <li><a href="#import-danych" id="toc-import-danych" class="nav-link" data-scroll-target="#import-danych"><span class="header-section-number">3.2</span> Import danych</a>
  <ul class="collapse">
  <li><a href="#pliki-csv" id="toc-pliki-csv" class="nav-link" data-scroll-target="#pliki-csv"><span class="header-section-number">3.2.1</span> Pliki CSV</a></li>
  <li><a href="#pliki-excel" id="toc-pliki-excel" class="nav-link" data-scroll-target="#pliki-excel"><span class="header-section-number">3.2.2</span> Pliki excel</a></li>
  <li><a href="#pliki-tekstowe" id="toc-pliki-tekstowe" class="nav-link" data-scroll-target="#pliki-tekstowe"><span class="header-section-number">3.2.3</span> Pliki tekstowe</a></li>
  </ul></li>
  <li><a href="#filtrowanie" id="toc-filtrowanie" class="nav-link" data-scroll-target="#filtrowanie"><span class="header-section-number">3.3</span> Filtrowanie</a></li>
  <li><a href="#wybieranie-kolumn" id="toc-wybieranie-kolumn" class="nav-link" data-scroll-target="#wybieranie-kolumn"><span class="header-section-number">3.4</span> Wybieranie kolumn</a></li>
  <li><a href="#tworzenie-nowych-zmiennych" id="toc-tworzenie-nowych-zmiennych" class="nav-link" data-scroll-target="#tworzenie-nowych-zmiennych"><span class="header-section-number">3.5</span> Tworzenie nowych zmiennych</a></li>
  <li><a href="#zmiana-nazwy-zmiennej" id="toc-zmiana-nazwy-zmiennej" class="nav-link" data-scroll-target="#zmiana-nazwy-zmiennej"><span class="header-section-number">3.6</span> Zmiana nazwy zmiennej</a></li>
  <li><a href="#podsumowanie-danych" id="toc-podsumowanie-danych" class="nav-link" data-scroll-target="#podsumowanie-danych"><span class="header-section-number">3.7</span> Podsumowanie danych</a></li>
  <li><a href="#grupowanie" id="toc-grupowanie" class="nav-link" data-scroll-target="#grupowanie"><span class="header-section-number">3.8</span> Grupowanie</a></li>
  <li><a href="#sortowanie" id="toc-sortowanie" class="nav-link" data-scroll-target="#sortowanie"><span class="header-section-number">3.9</span> Sortowanie</a></li>
  <li><a href="#≈ÇƒÖczenie-zbior√≥w" id="toc-≈ÇƒÖczenie-zbior√≥w" class="nav-link" data-scroll-target="#≈ÇƒÖczenie-zbior√≥w"><span class="header-section-number">3.10</span> ≈ÅƒÖczenie zbior√≥w</a></li>
  <li><a href="#szeroka-i-wƒÖska-reprezentacja-danych" id="toc-szeroka-i-wƒÖska-reprezentacja-danych" class="nav-link" data-scroll-target="#szeroka-i-wƒÖska-reprezentacja-danych"><span class="header-section-number">3.11</span> Szeroka i wƒÖska reprezentacja danych</a></li>
  <li><a href="#eksport-danych" id="toc-eksport-danych" class="nav-link" data-scroll-target="#eksport-danych"><span class="header-section-number">3.12</span> Eksport danych</a></li>
  <li><a href="#zadania" id="toc-zadania" class="nav-link" data-scroll-target="#zadania"><span class="header-section-number">3.13</span> Zadania</a>
  <ul class="collapse">
  <li><a href="#rossmann" id="toc-rossmann" class="nav-link" data-scroll-target="#rossmann"><span class="header-section-number">3.13.1</span> Rossmann</a></li>
  <li><a href="#wybory-2020" id="toc-wybory-2020" class="nav-link" data-scroll-target="#wybory-2020"><span class="header-section-number">3.13.2</span> Wybory 2020</a></li>
  <li><a href="#mistrzostwa-≈õwiata" id="toc-mistrzostwa-≈õwiata" class="nav-link" data-scroll-target="#mistrzostwa-≈õwiata"><span class="header-section-number">3.13.3</span> Mistrzostwa ≈öwiata</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Przetwarzanie danych</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><a href="presentations/02_wczytywanie.html">Prezentacja - wczytywanie danych</a></p>
<p><a href="presentations/03_przetwarzanie.html">Prezentacja - przetwarzanie</a></p>
<section id="wprowadzenie---pakiet-tidyverse" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="wprowadzenie---pakiet-tidyverse"><span class="header-section-number">3.1</span> Wprowadzenie - pakiet tidyverse</h2>
<p>Pakiet <code>tidyverse</code> to zestaw pakiet√≥w do kompleksowego przetwarzania i wizualizacji danych. ≈Åaduje nastƒôpujƒÖce pakiety:</p>
<ul>
<li>ggplot2 - tworzenie wykres√≥w,</li>
<li>dplyr - przetwarzanie danych,</li>
<li>tidyr - zmiana reprezentacji danych,</li>
<li>readr - wczytywanie danych tekstowych,</li>
<li>purrr - programowanie funkcyjne</li>
<li>tibble - spos√≥b przechowywania danych,</li>
<li>stringr - przetwarzanie tekst√≥w,</li>
<li>forcats - przetwarzanie faktor√≥w</li>
<li>lubridate - operacje na datach</li>
</ul>
<p>Manifest tidyverse ustala nastƒôpujƒÖce zasady:</p>
<ul>
<li>powt√≥rne u≈ºycie istniejƒÖcych struktur danych,</li>
<li>tworzenie czytelnych kod√≥w z operatorem pipe <code>%&gt;%</code> (ang. rura, przew√≥d, ≈ÇƒÖcznik).</li>
</ul>
<p>Wobec tego za≈Çadujmy pakiet <code>tidyverse</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>‚îÄ‚îÄ Attaching core tidyverse packages ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse 2.0.0 ‚îÄ‚îÄ
‚úî dplyr     1.1.2     ‚úî readr     2.1.4
‚úî forcats   1.0.0     ‚úî stringr   1.5.0
‚úî ggplot2   3.4.2     ‚úî tibble    3.2.1
‚úî lubridate 1.9.2     ‚úî tidyr     1.3.0
‚úî purrr     1.0.1     
‚îÄ‚îÄ Conflicts ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ tidyverse_conflicts() ‚îÄ‚îÄ
‚úñ dplyr::filter() masks stats::filter()
‚úñ dplyr::lag()    masks stats::lag()
‚Ñπ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors</code></pre>
</div>
</div>
<p>W konsoli pojawi siƒô informacja o wersji za≈Çadowanych pakiet√≥w oraz o konfliktach wystƒôpujƒÖcych pomiƒôdzy pakietami. Konflikty te wynikajƒÖ z takich samych nazw funkcji w r√≥≈ºnych pakietach. Kolejno≈õƒá wczytywania pakiet√≥w ma znaczenie - kolejny pakiet przykryje funkcje z wcze≈õniej wczytanego. Wywo≈Çanie przykrytej funkcji jest mo≈ºliwe poprzez zapis <code>nazwa_pakietu::nazwa_funkcji</code>.</p>
<p>Korzystanie z pakietu i zasad <code>tidyverse</code> to du≈ºo bardziej czytelny kod w por√≥wnaniu do wbudowanych funkcji. Poni≈ºej przedstawiony jest przyk≈Çad przetwarzania danych polegajƒÖcy na filtrowaniu, wyborze kolumn oraz utworzeniu nowej zmiennej.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"ChickWeight"</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># bez pakietu tidyverse</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>chick_15 <span class="ot">&lt;-</span> ChickWeight[ChickWeight<span class="sc">$</span>Chick<span class="sc">==</span><span class="st">"15"</span>,]</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>chick_15 <span class="ot">&lt;-</span> chick_15[<span class="fu">c</span>(<span class="st">"weight"</span>, <span class="st">"Time"</span>, <span class="st">"Diet"</span>),]</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>chick_15<span class="sc">$</span>weight_kg <span class="ot">&lt;-</span> chick_15<span class="sc">$</span>weight<span class="sc">/</span><span class="dv">1000</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># z pakietem tidyverse</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>chick_15 <span class="ot">&lt;-</span> ChickWeight <span class="sc">%&gt;%</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Chick<span class="sc">==</span><span class="st">"15"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Chick) <span class="sc">%&gt;%</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">weight_kg=</span>weight<span class="sc">/</span><span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>RozwiƒÖzanie z wykorzystaniem wbudowanych funkcji to 133 znaki, natomiast wykorzystanie <code>tidyverse</code> to 30% oszczƒôdno≈õƒá miejsca i tylko 92 znaki.</p>
</section>
<section id="import-danych" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="import-danych"><span class="header-section-number">3.2</span> Import danych</h2>
<p>Wczytywanie danych do R jest mo≈ºliwe z wielu r√≥≈ºnych ≈∫r√≥de≈Ç. Funkcje, kt√≥re to umo≈ºliwiajƒÖ zwykle majƒÖ nazwƒô rozpoczynajƒÖcƒÖ siƒô od <code>read</code>.</p>
<p>Bƒôdziemy korzystaƒá z nastƒôpujƒÖcych zbior√≥w danych:</p>
<ul>
<li><a href="data/movies.csv">movies</a> - plik tekstowy zawierajƒÖcy informacje o filmach,</li>
<li><a href="data/bank.xlsx">bank</a> - plik excel zawierajƒÖcy dane dot. kampanii marketingowej banku, <a href="data/bank_opis.pdf">opis zmiennych</a>,</li>
<li><a href="data/rossmann.xlsx">rossmann</a> - plik excel zawierajƒÖcy dane ze sklep√≥w Rossmann,</li>
<li><a href="http://www.mbnet.com.pl/dl.txt">lotto</a> - plik tekstowy zawierajƒÖcy dane z losowa≈Ñ Lotto.</li>
</ul>
<section id="pliki-csv" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="pliki-csv"><span class="header-section-number">3.2.1</span> Pliki CSV</h3>
<p>Do wczytywania plik√≥w csv mo≈ºna wykorzystaƒá wbudowanƒÖ funkcjƒô <code>read.csv()</code> lub tƒÖ pochodzƒÖcƒÖ z pakietu <code>readr</code> - <code>read_csv()</code>. W obu przypadkach wynik wczytania bƒôdzie podobny.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>movies <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"data/movies.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>movies2 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/movies.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 2961 Columns: 11
‚îÄ‚îÄ Column specification ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
Delimiter: ","
chr (3): title, genre, director
dbl (8): year, duration, gross, budget, cast_facebook_likes, votes, reviews,...

‚Ñπ Use `spec()` to retrieve the full column specification for this data.
‚Ñπ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<p>Je≈õli nas plik ma nietypowƒÖ strukturƒô to w funkcji <code>read.csv()</code> mo≈ºemy okre≈õliƒá dodatkowe argumenty informujƒÖc o nazwach kolumn obecnych w pliku (<code>header =</code>), separatorze kolumn (<code>sep =</code>) lub separatorze miejsc dziesiƒôtnych (<code>dec =</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>movies <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="at">file =</span> <span class="st">"data/movies.csv"</span>, <span class="at">header =</span> T, <span class="at">sep=</span><span class="st">","</span>, <span class="at">dec=</span><span class="st">"."</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pliki-excel" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="pliki-excel"><span class="header-section-number">3.2.2</span> Pliki excel</h3>
<p>Do wczytywania plik√≥w z Excela niezbƒôdny jest dodatkowy pakiet <code>readxl</code>. W funkcji <code>read_xlsx()</code> podajemy jako argument nazwƒô pliku. Mo≈ºemy tak≈ºe dodaƒá nazwƒô lub numer arkusza w argumencie (<code>sheet =</code>) oraz zakres kom√≥rek jako warto≈õƒá argumentu <code>range =</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>bank <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/bank.xlsx"</span>)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="co"># bank &lt;- read_xlsx("data/bank.xlsx", sheet = "dane")</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="co"># bank &lt;- read_xlsx("data/bank.xlsx", sheet = 1)</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>bank_a1i30 <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/bank.xlsx"</span>, <span class="at">range =</span> <span class="st">"A1:I30"</span>)</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>rossmann <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/rossmann.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="pliki-tekstowe" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="pliki-tekstowe"><span class="header-section-number">3.2.3</span> Pliki tekstowe</h3>
<p>Z kolei do wczytywania plik√≥w tekstowych wykorzystuje siƒô funkcjƒô <code>read.table()</code>. Wczytywany plik nie musi byƒá zlokalizowany na dysku twardym - mo≈ºe to byƒá link internetowy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>lotto <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="st">"http://www.mbnet.com.pl/dl.txt"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(lotto) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"lp"</span>, <span class="st">"data"</span>, <span class="st">"numery"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="filtrowanie" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="filtrowanie"><span class="header-section-number">3.3</span> Filtrowanie</h2>
<p>Do przetwarzania danych s≈Çu≈ºƒÖ funkcje z pakietu <code>dplyr</code>. Wiƒôkszo≈õƒá z nich jako pierwszy argument przyjmuje przetwarzany zbi√≥r danych, ale mo≈ºna tego uniknƒÖƒá wykorzystujƒÖc symbole <code>%&gt;%</code>.</p>
<p>Filtrowanie polega na wybraniu obserwacji, kt√≥re spe≈ÇniajƒÖ okre≈õlony warunek lub warunki. Ze zbioru <code>movies</code> wybierzmy wszystkie komedie:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>komedie <span class="ot">&lt;-</span> <span class="fu">filter</span>(movies, genre<span class="sc">==</span><span class="st">"Comedy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>lub alternatywnie:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>komedie <span class="ot">&lt;-</span> movies <span class="sc">%&gt;%</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genre<span class="sc">==</span><span class="st">"Comedy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Po zmiennej, kt√≥ra jest filtrowana musimy podaƒá operator por√≥wnania czyli podw√≥jny znak r√≥wno≈õci <code>==</code>. Je≈õli chcemy filtrowaƒá po wiƒôkszej liczbie zmiennych to kolejne warunki dodajemy po przecinku:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>komedie_2012 <span class="ot">&lt;-</span> movies <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genre<span class="sc">==</span><span class="st">"Comedy"</span>, year<span class="sc">==</span><span class="dv">2012</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>W√≥wczas oba warunki muszƒÖ zostaƒá spe≈Çnione czyli pomiƒôdzy nimi zachodzi relacja <code>i</code>. R√≥wnowa≈ºny zapis jest nastƒôpujƒÖcy:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>komedie_2012 <span class="ot">&lt;-</span> movies <span class="sc">%&gt;%</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genre<span class="sc">==</span><span class="st">"Comedy"</span> <span class="sc">&amp;</span> year<span class="sc">==</span><span class="dv">2012</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Pomiƒôdzy warunkami mo≈ºe tak≈ºe zachodziƒá relacja <code>lub</code>. Wybieramy filmy, kt√≥re sƒÖ komediami <strong>lub</strong> mia≈Çy swojƒÖ premierƒô w 2012 roku.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>komedie_l_2012 <span class="ot">&lt;-</span> movies <span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genre<span class="sc">==</span><span class="st">"Comedy"</span> <span class="sc">|</span> year<span class="sc">==</span><span class="dv">2012</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Mo≈ºliwy jest tak≈ºe wyb√≥r wielu kryteri√≥w filtrowania poprzez operator <code>%in%</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>komedie_familijne <span class="ot">&lt;-</span> movies <span class="sc">%&gt;%</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genre <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Comedy"</span>, <span class="st">"Family"</span>))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>movies_2000_2010 <span class="ot">&lt;-</span> movies <span class="sc">%&gt;%</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">%in%</span> <span class="dv">2000</span><span class="sc">:</span><span class="dv">2010</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="wybieranie-kolumn" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="wybieranie-kolumn"><span class="header-section-number">3.4</span> Wybieranie kolumn</h2>
<p>Do wyboru kolumn s≈Çu≈ºy funkcja <code>select()</code>. Zmodyfikujemy wcze≈õniej utworzony zbi√≥r <code>komedie</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>komedie <span class="ot">&lt;-</span> movies <span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genre<span class="sc">==</span><span class="st">"Comedy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(title, year, duration, budget, rating)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ten sam kod mo≈ºemy zapisaƒá zagnie≈ºd≈ºajƒÖc funkcje, ale traci on w ten spos√≥b na czytelno≈õci:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>komedie <span class="ot">&lt;-</span> <span class="fu">select</span>(<span class="fu">filter</span>(movies, genre<span class="sc">==</span><span class="st">"Comedy"</span>), title, year, duration, budget, rating)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Mo≈ºemy tak≈ºe wskazaƒá, kt√≥re zmienne nie majƒÖ znale≈∫ƒá siƒô w zbiorze wynikowym:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>komedie <span class="ot">&lt;-</span> movies <span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genre<span class="sc">==</span><span class="st">"Comedy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>genre)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Natomiast je≈õli zmiennych jest wiƒôcej to musimy jest umie≈õciƒá w wektorze, ≈ºeby nie pisaƒá przed ka≈ºdƒÖ zmiennƒÖ znaku minus:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>komedie <span class="ot">&lt;-</span> movies <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genre<span class="sc">==</span><span class="st">"Comedy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>genre, <span class="sc">-</span>director, <span class="sc">-</span>gross, <span class="sc">-</span>budget)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>komedie <span class="ot">&lt;-</span> movies <span class="sc">%&gt;%</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genre<span class="sc">==</span><span class="st">"Comedy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(genre, director, gross, budget))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Z wykorzystaniem znaku dwukropka mo≈ºemy tak≈ºe wskazywaƒá zakresy zmiennych:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>komedie <span class="ot">&lt;-</span> movies <span class="sc">%&gt;%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genre<span class="sc">==</span><span class="st">"Comedy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>genre, <span class="sc">-</span><span class="fu">c</span>(gross<span class="sc">:</span>reviews))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="tworzenie-nowych-zmiennych" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="tworzenie-nowych-zmiennych"><span class="header-section-number">3.5</span> Tworzenie nowych zmiennych</h2>
<p>Do utworzenia nowej zmiennej wykorzystuje siƒô funkcjƒô <code>mutate()</code>. Utw√≥rzmy w naszym zbiorze nowƒÖ zmiennƒÖ, kt√≥ra bƒôdzie zawiera≈Ça czas trwania filmu w godzinach:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>komedie <span class="ot">&lt;-</span> movies <span class="sc">%&gt;%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genre<span class="sc">==</span><span class="st">"Comedy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>genre, <span class="sc">-</span><span class="fu">c</span>(gross<span class="sc">:</span>reviews)) <span class="sc">%&gt;%</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dur_hour =</span> duration<span class="sc">/</span><span class="dv">60</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>RozsƒÖdnie bƒôdzie zaokrƒÖgliƒá otrzymanƒÖ warto≈õƒá do jednego miejsca po przecinku - s≈Çu≈ºy do tego funkcja <code>round()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>komedie <span class="ot">&lt;-</span> movies <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genre<span class="sc">==</span><span class="st">"Comedy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>genre, <span class="sc">-</span><span class="fu">c</span>(gross<span class="sc">:</span>reviews)) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">dur_hour =</span> <span class="fu">round</span>(duration<span class="sc">/</span><span class="dv">60</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Z kolei funkcja <code>transmute()</code> tworzy zbi√≥r w kt√≥rym jest tylko nowo utworzona kolumna:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>komedie_t <span class="ot">&lt;-</span> movies <span class="sc">%&gt;%</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(genre<span class="sc">==</span><span class="st">"Comedy"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>genre, <span class="sc">-</span><span class="fu">c</span>(gross<span class="sc">:</span>reviews)) <span class="sc">%&gt;%</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">dur_hour =</span> <span class="fu">round</span>(duration<span class="sc">/</span><span class="dv">60</span>,<span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="zmiana-nazwy-zmiennej" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="zmiana-nazwy-zmiennej"><span class="header-section-number">3.6</span> Zmiana nazwy zmiennej</h2>
<p>Do zmiany nazw zmiennych s≈Çu≈ºy funkcja <code>rename()</code>. Najpierw podajemy nazwƒô nowej zmiennej, a po znaku r√≥wno≈õci starƒÖ nazwƒô:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>bank <span class="ot">&lt;-</span> bank <span class="sc">%&gt;%</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">karta=</span>kredyt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Zmiany nazwy mo≈ºna tak≈ºe dokonaƒá z wykorzystaniem funkcji <code>select</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>bank_nowy <span class="ot">&lt;-</span> bank <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="at">lokata=</span>wynik)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>W takim przypadku trzeba jednak pamiƒôtaƒá o wypisaniu wszystkich zmiennych, kt√≥re majƒÖ siƒô znale≈∫ƒá w zbiorze wynikowym.</p>
</section>
<section id="podsumowanie-danych" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="podsumowanie-danych"><span class="header-section-number">3.7</span> Podsumowanie danych</h2>
<p>Funkcja <code>summarise()</code> s≈Çu≈ºy do podsumowa≈Ñ danych w formie zagregowanej:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>bank <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">saldo_srednia=</span><span class="fu">mean</span>(saldo),</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">saldo_mediana=</span><span class="fu">median</span>(saldo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 √ó 2
  saldo_srednia saldo_mediana
          &lt;dbl&gt;         &lt;dbl&gt;
1         1362.           448</code></pre>
</div>
</div>
<p>Podsumowanie danych ma najwiƒôcej sensu w po≈ÇƒÖczniu z funkcjƒÖ grupujƒÖcƒÖ.</p>
</section>
<section id="grupowanie" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="grupowanie"><span class="header-section-number">3.8</span> Grupowanie</h2>
<p>Do grupowania obserwacji s≈Çu≈ºy funkcja <code>group_by()</code>. Zobaczmy jak wyglƒÖdajƒÖ statystyki salda w poszczeg√≥lnych grupach wykszta≈Çcenia:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>bank <span class="sc">%&gt;%</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wykszt) <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">saldo_srednia=</span><span class="fu">mean</span>(saldo),</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">saldo_mediana=</span><span class="fu">median</span>(saldo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 √ó 3
  wykszt     saldo_srednia saldo_mediana
  &lt;chr&gt;              &lt;dbl&gt;         &lt;dbl&gt;
1 podstawowe         1251.           403
2 srednie            1155.           392
3 wyzsze             1758.           577
4 &lt;NA&gt;               1527.           568</code></pre>
</div>
</div>
<p>Po przecinku w funkcji <code>group_by()</code> mo≈ºna wskazaƒá kolejne zmienne grupujƒÖce:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>bank <span class="sc">%&gt;%</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wykszt, hipoteka) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">saldo_srednia=</span><span class="fu">mean</span>(saldo),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">saldo_mediana=</span><span class="fu">median</span>(saldo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'wykszt'. You can override using the
`.groups` argument.</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 8 √ó 4
# Groups:   wykszt [4]
  wykszt     hipoteka saldo_srednia saldo_mediana
  &lt;chr&gt;      &lt;chr&gt;            &lt;dbl&gt;         &lt;dbl&gt;
1 podstawowe nie              1571.          521 
2 podstawowe tak              1008.          344.
3 srednie    nie              1340.          416.
4 srednie    tak              1034.          380 
5 wyzsze     nie              1919.          618 
6 wyzsze     tak              1584.          543 
7 &lt;NA&gt;       nie              1780.          679 
8 &lt;NA&gt;       tak              1207.          442 </code></pre>
</div>
</div>
<p>Przydatna jest tak≈ºe funkcja <code>n()</code>, kt√≥ra nie przyjmuje ≈ºadnego argumentu i zwraca liczebno≈õƒá zbioru bƒÖd≈∫ grupy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>bank <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wykszt) <span class="sc">%&gt;%</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">liczebnosc=</span><span class="fu">n</span>(),</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">saldo_srednia=</span><span class="fu">mean</span>(saldo),</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">saldo_mediana=</span><span class="fu">median</span>(saldo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 √ó 4
  wykszt     liczebnosc saldo_srednia saldo_mediana
  &lt;chr&gt;           &lt;int&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 podstawowe       6851         1251.           403
2 srednie         23202         1155.           392
3 wyzsze          13301         1758.           577
4 &lt;NA&gt;             1857         1527.           568</code></pre>
</div>
</div>
<p>Je≈ºeli chcemy tylko wyznaczyƒá liczebno≈õci grup to mo≈ºemy skorzystaƒá z funkcji <code>count()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>bank <span class="sc">%&gt;%</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wykszt) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 √ó 2
# Groups:   wykszt [4]
  wykszt         n
  &lt;chr&gt;      &lt;int&gt;
1 podstawowe  6851
2 srednie    23202
3 wyzsze     13301
4 &lt;NA&gt;        1857</code></pre>
</div>
</div>
<p>JednƒÖ z kategorii zmiennej wykszta≈Çcenie jest brak danych (<code>NA</code>). Zamienimy tƒÖ warto≈õƒá na kategoriƒô <em>nieustalone</em> z wykorzystaniem funkcji <code>mutate()</code> oraz <code>if_else()</code>. Funkcja <code>if_else()</code> przyjmuje trzy argumenty - pierwszy (<code>condition =</code>) to warunek, kt√≥ry jest weryfikowany, nastƒôpnie podajemy warto≈õƒá, kt√≥ra ma byƒá wprowadzona w przypadku spe≈Çnienia warunku (<code>true =</code>), a na ko≈Ñcu warto≈õƒá dla niespe≈Çnionego warunku (<code>false =</code>). Jest to odpowiednik funkcji <code>JE≈ªELI</code> z Excela.</p>
<p>W omawianym przyk≈Çadzie warunkiem jest sprawdzenie czy warto≈õci zmiennej <code>wykszt</code> sƒÖ r√≥wne <code>NA</code>. Je≈õli tak to na ich miejsce wprowadzany jest tekst <em>nieustalone</em>, a w przeciwnym przypadku pozostaje oryginalna warto≈õƒá.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>bank <span class="sc">%&gt;%</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">wykszt=</span><span class="fu">if_else</span>(<span class="fu">is.na</span>(wykszt), <span class="st">"nieustalone"</span>, wykszt)) <span class="sc">%&gt;%</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wykszt) <span class="sc">%&gt;%</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 √ó 2
# Groups:   wykszt [4]
  wykszt          n
  &lt;chr&gt;       &lt;int&gt;
1 nieustalone  1857
2 podstawowe   6851
3 srednie     23202
4 wyzsze      13301</code></pre>
</div>
</div>
</section>
<section id="sortowanie" class="level2" data-number="3.9">
<h2 data-number="3.9" class="anchored" data-anchor-id="sortowanie"><span class="header-section-number">3.9</span> Sortowanie</h2>
<p>Sortowanie jest mo≈ºliwe z wykorzystaniem funkcji <code>arrange()</code>. Jako argument podajemy zmiennƒÖ wed≈Çug, kt√≥rej chcemy posortowaƒá zbi√≥r. Domy≈õlne zbi√≥r sortowany jest rosnƒÖco - od warto≈õci najmniejszych do najwiƒôkszych:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>bank_sort <span class="ot">&lt;-</span> bank <span class="sc">%&gt;%</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(saldo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Zmiana kierunku sortowania jest mo≈ºliwa po zastosowaniu funkcji <code>desc()</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>bank_sort <span class="ot">&lt;-</span> bank <span class="sc">%&gt;%</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(saldo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sortowanie mo≈ºemy tak≈ºe zastosowaƒá do wynik√≥w podsumowania danych:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>bank <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(wykszt) <span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">liczebnosc=</span><span class="fu">n</span>(),</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">saldo_srednia=</span><span class="fu">mean</span>(saldo),</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">saldo_mediana=</span><span class="fu">median</span>(saldo)) <span class="sc">%&gt;%</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(saldo_srednia)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 √ó 4
  wykszt     liczebnosc saldo_srednia saldo_mediana
  &lt;chr&gt;           &lt;int&gt;         &lt;dbl&gt;         &lt;dbl&gt;
1 srednie         23202         1155.           392
2 podstawowe       6851         1251.           403
3 &lt;NA&gt;             1857         1527.           568
4 wyzsze          13301         1758.           577</code></pre>
</div>
</div>
</section>
<section id="≈ÇƒÖczenie-zbior√≥w" class="level2" data-number="3.10">
<h2 data-number="3.10" class="anchored" data-anchor-id="≈ÇƒÖczenie-zbior√≥w"><span class="header-section-number">3.10</span> ≈ÅƒÖczenie zbior√≥w</h2>
<p>W celu zaprezentowania funkcji ≈ÇƒÖczƒÖcych dane przygotujemy kilka zbior√≥w pomocniczych:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>praca_czas <span class="ot">&lt;-</span> bank <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(praca) <span class="sc">%&gt;%</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sr_czas=</span><span class="fu">mean</span>(czas))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>praca_saldo <span class="ot">&lt;-</span> bank <span class="sc">%&gt;%</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(praca) <span class="sc">%&gt;%</span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sr_saldo=</span><span class="fu">mean</span>(saldo))</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>zawod_saldo <span class="ot">&lt;-</span> bank <span class="sc">%&gt;%</span></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">zawod=</span>praca) <span class="sc">%&gt;%</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(zawod) <span class="sc">%&gt;%</span></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sr_saldo=</span><span class="fu">mean</span>(saldo))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Do ≈ÇƒÖczenia dw√≥ch zbior√≥w danych s≈Çu≈ºy funkcja <code>inner_join()</code>, kt√≥ra jako argumenty przyjmuje nazwy zbior√≥w danych oraz klucz ≈ÇƒÖczenia. Je≈õli w obu zbiorach wystƒôpujƒÖ kolumny o takich samych nazwach to zostanƒÖ potraktowane jako klucz ≈ÇƒÖczenia:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>praca_czas_saldo <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(praca_czas, praca_saldo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(praca)`</code></pre>
</div>
</div>
<p>Je≈õli takie kolumny nie bƒôdƒÖ istnia≈Çy to wywo≈Çanie funkcji zwr√≥ci b≈ÇƒÖd:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>praca_czas_saldo <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(praca_czas, zawod_saldo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in `inner_join()`:
! `by` must be supplied when `x` and `y` have no common variables.
‚Ñπ Use `cross_join()` to perform a cross-join.</code></pre>
</div>
</div>
<p>W takich przypadku nale≈ºy wskazaƒá klucz po≈ÇƒÖczenia w postaci <code>by = c("id1"="id2")</code>:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>praca_czas_saldo <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(praca_czas, zawod_saldo, <span class="at">by=</span><span class="fu">c</span>(<span class="st">"praca"</span><span class="ot">=</span><span class="st">"zawod"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Je≈õli w jednym ze zbior√≥w nie ma wszystkich identyfikator√≥w, kt√≥re znajdujƒÖ siƒô w drugim zbiorze to zastosowanie funkcji <code>inner_join()</code> bƒôdzie skutkowa≈Ço zbiorem, w kt√≥rym znajdƒÖ siƒô tylko te obserwacje, kt√≥re uda≈Ço siƒô po≈ÇƒÖczyƒá.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>praca_saldo_1500 <span class="ot">&lt;-</span> praca_saldo <span class="sc">%&gt;%</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sr_saldo <span class="sc">&gt;</span> <span class="dv">1500</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="fu">inner_join</span>(praca_czas, praca_saldo_1500, <span class="at">by=</span><span class="st">"praca"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 √ó 3
  praca sr_czas sr_saldo
  &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
1     2    289.    1522.
2     3    254.    1764.
3     5    256.    1521.
4     7    268.    1648.
5     8    287.    1984.
6    NA    238.    1772.</code></pre>
</div>
</div>
<p>Je≈õli chcemy pozostawiƒá niedopasowane obserwacje to nale≈ºy wykorzystaƒá jednƒÖ z funkcji - <code>left_join()</code> lub <code>right_join()</code> w zale≈ºno≈õci od tego dla kt√≥rego zbioru chcemy pozostawiƒá wszystkie informacje.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">left_join</span>(praca_czas, praca_saldo_1500, <span class="at">by=</span><span class="st">"praca"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 11 √ó 3
   praca sr_czas sr_saldo
   &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;
 1     1    247.      NA 
 2     2    289.    1522.
 3     3    254.    1764.
 4     4    246.      NA 
 5     5    256.    1521.
 6     6    263.      NA 
 7     7    268.    1648.
 8     8    287.    1984.
 9     9    253.      NA 
10    10    257.      NA 
11    NA    238.    1772.</code></pre>
</div>
</div>
</section>
<section id="szeroka-i-wƒÖska-reprezentacja-danych" class="level2" data-number="3.11">
<h2 data-number="3.11" class="anchored" data-anchor-id="szeroka-i-wƒÖska-reprezentacja-danych"><span class="header-section-number">3.11</span> Szeroka i wƒÖska reprezentacja danych</h2>
<p>Do wyja≈õnienia kwestii szerokiej i wƒÖskiej reprezentacji danych pos≈Çu≈ºymy siƒô danymi z GUS dotyczƒÖcymi przeciƒôtnego miesiƒôcznego spo≈ºycie wybranych artyku≈Ç√≥w ≈ºywno≈õciowych na 1 osobƒô w 2016 roku - <a href="data/spozycie.xlsx">plik</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>spozycie <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/spozycie.xlsx"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Taka tabela jest przyk≈Çadem szerokiej reprezentacji danych. Z kolei w niekt√≥rych sytuacjach wygodnie jest korzystaƒá z wƒÖskiej reprezentacji danych, a niekt√≥re pakiety wrƒôcz wymagajƒÖ takich zbior√≥w wej≈õciowych.</p>
<p>Do transformacji danych z reprezentacji szerokiej na wƒÖskƒÖ s≈Çu≈ºy funkcja <code>gather()</code> (pol. <em>gromadziƒá</em>). Kluczowe sƒÖ w niej dwa argumenty - pierwszy (<code>key</code>) okre≈õla nazwƒô nowej kolumny, kt√≥ra bƒôdzie zawiera≈Ça nazwy zmiennych, a drugi (<code>value</code>) okre≈õla nazwƒô nowej kolumny, kt√≥ra bƒôdzie zawiera≈Ça warto≈õci zmiennych. Jako kolejne argumenty podaje siƒô nazwy kolumn, kt√≥re majƒÖ byƒá transformowane lub nazwy kolumn ze znakiem minus <code>-</code>, kt√≥re nie majƒÖ byƒá transformowane.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>spozycie_waskie <span class="ot">&lt;-</span> spozycie <span class="sc">%&gt;%</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(artykul, spozycie, mieso, owoce, warzywa)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="co"># spozycie_waskie &lt;- spozycie %&gt;%</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="co">#   gather(artykul, spozycie, -kod, -nazwa)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>W takiej formie ≈Çatwiej podsumowaƒá dane:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>spozycie_waskie <span class="sc">%&gt;%</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(artykul) <span class="sc">%&gt;%</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sr_spozycie=</span><span class="fu">mean</span>(spozycie))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 √ó 2
  artykul sr_spozycie
  &lt;chr&gt;         &lt;dbl&gt;
1 mieso          5.47
2 owoce          3.65
3 warzywa        8.85</code></pre>
</div>
</div>
<p>W por√≥wnaniu do szerokiej reprezentacji danych:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>spozycie <span class="sc">%&gt;%</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">sr_spozycie_mieso=</span><span class="fu">mean</span>(mieso),</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">sr_spozycie_owoce=</span><span class="fu">mean</span>(owoce),</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">sr_spozycie_warzywa=</span><span class="fu">mean</span>(warzywa))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 √ó 3
  sr_spozycie_mieso sr_spozycie_owoce sr_spozycie_warzywa
              &lt;dbl&gt;             &lt;dbl&gt;               &lt;dbl&gt;
1              5.47              3.65                8.85</code></pre>
</div>
</div>
<p>Transformacja z wƒÖskiej do szerokiej reprezentacji danych jest mo≈ºliwa z zastosowaniem funkcji <code>spread()</code> (pol. <em>rozprzestrzeniaƒá</em>). W przypadku tej funkcji niezbƒôdne sƒÖ dwa argumenty - pierwszy (<code>key</code>) wskazuje kolumnƒô zawierajƒÖcƒÖ nazwy dla nowych zmiennych, a drugi argument (<code>value</code>) wskazuje kolumnƒô zawierajƒÖcƒÖ warto≈õci dla nowych zmiennych.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>spozycie_szerokie <span class="ot">&lt;-</span> spozycie_waskie <span class="sc">%&gt;%</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(artykul, spozycie)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="eksport-danych" class="level2" data-number="3.12">
<h2 data-number="3.12" class="anchored" data-anchor-id="eksport-danych"><span class="header-section-number">3.12</span> Eksport danych</h2>
<p>Zapis zbioru danych do zewnƒôtrznego pliku jest mo≈ºliwy z wykorzystaniem funkcji <code>write.table()</code>. Jako argumenty tej funkcji okre≈õlamy: zbi√≥r danych (<code>x</code>), docelowe miejsce na dysku i nazwƒô pliku (<code>file</code>), separator kolumn (<code>sep</code>), separator miejsc dziesiƒôtnych (<code>dec</code>) oraz argument <code>row.names = FALSE</code>, dziƒôki kt√≥remu unikniemy dodatkowych numer√≥w wierszy.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.table</span>(spozycie_waskie, <span class="at">file =</span> <span class="st">"data/spozycie_w.csv"</span>, <span class="at">sep=</span><span class="st">";"</span>, <span class="at">dec=</span><span class="st">","</span>, <span class="at">row.names=</span>F)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Taki plik jest plikiem csv, kt√≥ry mo≈ºemy otworzyƒá w Excelu i zapisaƒá go z rozszerzeniem .xlsx. Teoretycznie istnieje pakiet <code>xlsx</code>, kt√≥ry umo≈ºliwia zapisywanie zbior√≥w od razu do Excela, ale dzia≈Ça w oparciu o Javƒô, co bywa problematyczne.</p>
</section>
<section id="zadania" class="level2" data-number="3.13">
<h2 data-number="3.13" class="anchored" data-anchor-id="zadania"><span class="header-section-number">3.13</span> Zadania</h2>
<section id="rossmann" class="level3" data-number="3.13.1">
<h3 data-number="3.13.1" class="anchored" data-anchor-id="rossmann"><span class="header-section-number">3.13.1</span> Rossmann</h3>
<p>Na podstawie <a href="http://wawrowski.edu.pl/data/rossmann.xlsx">zbioru Rossmann</a> odpowied≈∫ na pytania:</p>
<ol type="1">
<li>Ile by≈Ço sklep√≥w o asortymencie rozszerzonym w dniu 25-02-2014?</li>
<li>W jaki dzie≈Ñ tygodnia ≈õrednia liczba klient√≥w by≈Ça najwiƒôksza w sklepie nr 101?</li>
<li>Sklep jakiego typu charakteryzuje siƒô najwiƒôkszƒÖ medianƒÖ sprzeda≈ºy?</li>
<li>Czy w ciƒÖgu roku odleg≈Ço≈õƒá do najbli≈ºszego sklepu konkurencji zmieni≈Ça siƒô dla jakiegokolwiek sklepu Rossmann?</li>
<li>Po≈ÇƒÖcz dane ze sklep√≥w Rossmann z danymi o ≈õrednim kursie EUR/PLN z 2014 roku, kt√≥ry mo≈ºna pobraƒá ze strony <a href="http://www.nbp.pl/home.aspx?f=/kursy/arch_a.html">NBP</a>. Przelicz wielko≈õƒá sprzeda≈ºy na z≈Çot√≥wki.</li>
</ol>
</section>
<section id="wybory-2020" class="level3" data-number="3.13.2">
<h3 data-number="3.13.2" class="anchored" data-anchor-id="wybory-2020"><span class="header-section-number">3.13.2</span> Wybory 2020</h3>
<p>Na podstawie <a href="http://wawrowski.edu.pl/data/wybory2020.xlsx">zbioru dotyczƒÖcego wybor√≥w prezydenckich w 2020 roku</a> odpowied≈∫ na pytania:</p>
<ol type="1">
<li>Ile obwod√≥w g≈Çosowania mia≈Ço frekwencjƒô powy≈ºej 80%?</li>
<li>Ile obwod√≥w g≈Çosowania znajduje siƒô w Poznaniu?<br>
</li>
<li>Ile jest obwod√≥w wed≈Çug typu obszaru?</li>
<li>Jaka by≈Ça ≈õrednia frekwencja w wojew√≥dztwach?</li>
<li>Gdzie by≈Ça najwiƒôksza r√≥≈ºnica pomiƒôdzy kandydatami?</li>
</ol>
</section>
<section id="mistrzostwa-≈õwiata" class="level3" data-number="3.13.3">
<h3 data-number="3.13.3" class="anchored" data-anchor-id="mistrzostwa-≈õwiata"><span class="header-section-number">3.13.3</span> Mistrzostwa ≈öwiata</h3>
<p>Na podstawie <a href="http://wawrowski.edu.pl/data/WorldCupMatches.xlsx">zbioru dotyczƒÖcego wynik√≥w mecz√≥w rozegranych w ramach Mistrzostw ≈öwiata</a> odpowied≈∫ na pytania:</p>
<ol type="1">
<li>Ile razy W≈Çochy gra≈Çy w finale M≈ö?</li>
<li>Jaka jest najwiƒôksza liczba bramek w jednym meczu?<br>
</li>
<li>Jakie miasto najczƒô≈õciej go≈õci≈Ço pi≈Çkarzy?</li>
<li>Jaka by≈Ça ≈õrednia liczba widz√≥w?</li>
<li>Ile by≈Ço mecz√≥w, w kt√≥rych dru≈ºyna prowadzƒÖca po pierwszej po≈Çowie ostatecznie przegrywa≈Ça?</li>
</ol>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-struktury.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Struktury danych</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-wizualizacja.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Wizualizacja danych</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>