<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Metody przetwarzania i analizy danych w R - 3&nbsp; Regresja</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-grupowanie.html" rel="next">
<link href="./02-testy.html" rel="prev">
<link href="./favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Regresja</span></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Metody przetwarzania i analizy danych w R</a> 
    </div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Wprowadzenie</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-eda.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Analiza opisowa</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-testy.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Testowanie hipotez</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-regresja.html" class="sidebar-item-text sidebar-link active"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Regresja</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-grupowanie.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Grupowanie</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-klasyfikacja.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Klasyfikacja</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Spis tre≈õci</h2>
   
  <ul>
  <li><a href="#wprowadzenie" id="toc-wprowadzenie" class="nav-link active" data-scroll-target="#wprowadzenie"> <span class="header-section-number">3.1</span> Wprowadzenie</a></li>
  <li><a href="#regresja-prosta" id="toc-regresja-prosta" class="nav-link" data-scroll-target="#regresja-prosta"> <span class="header-section-number">3.2</span> Regresja prosta</a>
  <ul class="collapse">
  <li><a href="#zadanie" id="toc-zadanie" class="nav-link" data-scroll-target="#zadanie"> <span class="header-section-number">3.2.1</span> Zadanie</a></li>
  </ul></li>
  <li><a href="#regresja-wieloraka" id="toc-regresja-wieloraka" class="nav-link" data-scroll-target="#regresja-wieloraka"> <span class="header-section-number">3.3</span> Regresja wieloraka</a>
  <ul class="collapse">
  <li><a href="#zadanie-1" id="toc-zadanie-1" class="nav-link" data-scroll-target="#zadanie-1"> <span class="header-section-number">3.3.1</span> Zadanie</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Regresja</span></h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<p><a href="presentations/04_regresja.html">Prezentacja</a></p>
<section id="wprowadzenie" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="wprowadzenie"><span class="header-section-number">3.1</span> Wprowadzenie</h2>
<p>Metody regresji pozwalajƒÖ na analizowanie zale≈ºno≈õci przyczynowo-skutkowych oraz predycjƒô nieznanych warto≈õci. KorzystajƒÖc z tej metody nale≈ºy jednak pamiƒôtaƒá, ≈ºe model regresji jest tylko przybli≈ºeniem rzeczywisto≈õci.</p>
<p>Przyk≈Çady zastosowania regresji:</p>
<ul>
<li><p>zale≈ºno≈õƒá wielko≈õci sprzeda≈ºy od wydatk√≥w na reklamƒô</p></li>
<li><p>zale≈ºno≈õƒá wynagrodzenia od lat do≈õwiadczenia</p></li>
</ul>
<p>Na poczƒÖtku pracy wczytujemy biblioteki <em>tidyverse</em> i <em>readxl</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="regresja-prosta" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="regresja-prosta"><span class="header-section-number">3.2</span> Regresja prosta</h2>
<p>Na podstawie <a href="data/salary.xlsx">danych</a> dotyczƒÖcych informacji o do≈õwiadczeniu i wynagrodzeniu pracownik√≥w zbuduj model okre≈õlajƒÖcy ‚Äòwide≈Çki‚Äô dla potencjalnych pracownik√≥w o do≈õwiadczeniu r√≥wnym 8, 10 i 11 lat.</p>
<p>Wczytujemy dane i sprawdzamy czy nie wystƒôpujƒÖ zera bƒÖd≈∫ braki danych z u≈ºyciem funkcji <code>summary()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>salary <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/salary.xlsx"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(salary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> YearsExperience      Salary      
 Min.   : 1.100   Min.   : 37731  
 1st Qu.: 3.200   1st Qu.: 56721  
 Median : 4.700   Median : 65237  
 Mean   : 5.313   Mean   : 76003  
 3rd Qu.: 7.700   3rd Qu.:100545  
 Max.   :10.500   Max.   :122391  </code></pre>
</div>
</div>
<p>Nastƒôpnie stworzymy wykres.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(salary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-regresja_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Najprostszym sposobem wizualizacji jest wykorzystanie funkcji <code>plot()</code>, niemniej taki wykres nie jest najpiƒôkniejszy i trudno siƒô go formatuje. Du≈ºo lepiej skorzystaƒá z pakietu <code>ggplot2</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(salary, <span class="fu">aes</span>(<span class="at">x=</span>YearsExperience, <span class="at">y=</span>Salary)) <span class="sc">+</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Do≈õwiadczenie"</span>) <span class="sc">+</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Pensja"</span>) <span class="sc">+</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">35000</span>, <span class="dv">126000</span>) <span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="03-regresja_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>W argumentach funkcji <code>ggplot()</code> podajemy co wizualizujemy, natomiast spos√≥b prezentacji ustalany jest przez funkcje <code>geom</code>. Funkcje <code>xlab()</code> i <code>ylab()</code> okre≈õlajƒÖ etykiety osi, a <code>xlim()</code> i <code>ylim()</code> warto≈õci graniczne. Funkcje rozpoczynajƒÖce siƒô od <code>theme_</code> okre≈õlajƒÖ wyglƒÖd wykresu.</p>
<p>Modelowanie rozpoczynamy od okre≈õlenia zmiennej zale≈ºnej i niezale≈ºnej.</p>
<ul>
<li>zmienna zale≈ºna/obja≈õniana: pensja - <span class="math inline">\(y\)</span></li>
<li>zmienna niezale≈ºna/obja≈õniajƒÖca: do≈õwiadczenie - <span class="math inline">\(x\)</span></li>
</ul>
<p>Szukamy teraz wzoru na prostƒÖ opisujƒÖcƒÖ badane cechy.</p>
<p>Og√≥lna postaƒá regresji prostej jest nastƒôpujƒÖca:</p>
<p><span class="math display">\[\hat{y}_{i}=b_{1}x_{i}+b_{0}\]</span></p>
<p>gdzie <span class="math inline">\(\hat{y}\)</span> oznacza warto≈õƒá teoretycznƒÖ, le≈ºƒÖcƒÖ na wyznaczonej prostej, <span class="math inline">\(x_i\)</span> warto≈õƒá zmiennej niezale≈ºnej, a <span class="math inline">\(b_1\)</span> i <span class="math inline">\(b_0\)</span> to wsp√≥≈Çczynniki modelu.</p>
<p>Wobec tego warto≈õci empiryczne <span class="math inline">\(y\)</span> bƒôdƒÖ opisane formu≈ÇƒÖ:</p>
<p><span class="math display">\[y_{i}=b_{1}x_{i}+b_{0}+u_{i}\]</span></p>
<p>w kt√≥rej <span class="math inline">\(u_i\)</span> oznacza sk≈Çadnik resztowy wyliczany jako <span class="math inline">\(u_{i}=y_{i}-\hat{y}_{i}\)</span>.</p>
<p><strong>Wsp√≥≈Çczynnik kierunkowy</strong> <span class="math inline">\(b_1\)</span> informuje o ile przeciƒôtne zmieni siƒô warto≈õƒá zmiennej obja≈õnianej <span class="math inline">\(y\)</span>, gdy warto≈õƒá zmiennej obja≈õniajƒÖcej <span class="math inline">\(x\)</span> wzro≈õnie o jednostkƒô.</p>
<p><strong>Wyraz wolny</strong> <span class="math inline">\(b_0\)</span> to warto≈õƒá zmiennej obja≈õnianej <span class="math inline">\(y\)</span>, w sytuacji w kt√≥rej warto≈õƒá zmiennej obja≈õniajƒÖcej <span class="math inline">\(x\)</span> bƒôdzie r√≥wna 0. Czƒôsto interpretacja tego parametru nie ma sensu.</p>
<p>Nastƒôpnie w R korzystamy z funkcji <code>lm</code>, w kt√≥rej nale≈ºy okre≈õliƒá zale≈ºno≈õƒá funkcyjnƒÖ w formie: <code>zmienna_zalezna ~ zmienna niezalezna</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>salary_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="at">formula =</span> Salary <span class="sc">~</span> YearsExperience, <span class="at">data =</span> salary)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(salary_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Salary ~ YearsExperience, data = salary)

Residuals:
    Min      1Q  Median      3Q     Max 
-7958.0 -4088.5  -459.9  3372.6 11448.0 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      25792.2     2273.1   11.35 5.51e-12 ***
YearsExperience   9450.0      378.8   24.95  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 5788 on 28 degrees of freedom
Multiple R-squared:  0.957, Adjusted R-squared:  0.9554 
F-statistic: 622.5 on 1 and 28 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Na podstawie otrzymanego wyniku dokonujemy interpretacji parametr√≥w.</p>
<ul>
<li>b1 = 9450 - wzrost do≈õwiadczenia o rok powoduje przeciƒôtny wzrost pensji o 9450 $</li>
<li>b0 = 25792,2 - pracownik o do≈õwiadczeniu 0 lat uzyska pensjƒô w wysoko≈õci 25792,2 $</li>
</ul>
<p>Trzy gwiazki przy wsp√≥≈Çczynniku <span class="math inline">\(b_1\)</span> oznaczajƒÖ, ≈ºe do≈õwiadczenie ma istotny wp≈Çyw na warto≈õci pensji. Wyraz wolny tak≈ºe jest istotny, natomiast og√≥lnie nie jest wymagana jesgo istotno≈õƒá.</p>
<p>Opr√≥cz interpretacji wsp√≥≈Çczynnik√≥w wa≈ºne sƒÖ jeszcze inne miary jako≈õci modelu.</p>
<p><strong>Odchylenie standardowe sk≈Çadnika resztowego</strong> jest pierwiastkiem z sumy kwadrat√≥w reszt podzielonej przez liczbƒô obserwacji pomniejszonƒÖ o 2:</p>
<p><span class="math display">\[S_{u}=\sqrt{\frac{\sum\limits_{i=1}^{n}{(y_{i}-\hat{y}_{i})^2}}{n-2}}\]</span></p>
<p>B≈ÇƒÖd resztowy (odchylenie standardowe sk≈Çadnika resztowego) <span class="math inline">\(S_u\)</span> wynosi 5788$, co oznacza, ≈ºe warto≈õci obliczone na podstawie modelu r√≥≈ºniƒÖ siƒô od rzeczywisto≈õci ≈õrednio o +/- 5788 $</p>
<p><strong>Wsp√≥≈Çczynnik determinacji</strong> okre≈õla, jaki procent wariancji zmiennej obja≈õnianej zosta≈Ç wyja≈õniony przez funkcjƒô regresji. <span class="math inline">\(R^2\)</span> przyjmuje warto≈õci z przedzia≈Çu <span class="math inline">\(&lt;0;1&gt;\)</span> ( <span class="math inline">\(&lt;0\%;100\%&gt;\)</span> ), przy czym model regresji tym lepiej opisuje zachowanie siƒô badanej zmiennej obja≈õnianej, im <span class="math inline">\(R^2\)</span> jest bli≈ºszy jedno≈õci (bli≈ºszy 100%)</p>
<p><span class="math display">\[R^2=1-\frac{\sum\limits_{i=1}^{n}{(y_{i}-\hat{y}_{i})^2}}{\sum\limits_{i=1}^{n}{(y_{i}-\bar{y}_{i})^2}}\]</span></p>
<p>Wsp√≥≈Çczynnik <span class="math inline">\(R^2\)</span> (multiple R-squared) wynosi 0,957 czyli do≈õwiadczenie wyja≈õnia 95,7% zmienno≈õci pensji</p>
<p>Na podstawie tego modelu dokonamy wyznaczenia warto≈õci teoretycznych dla kilku wybranych warto≈õci do≈õwiadczenia. Nowe warto≈õci muszƒÖ byƒá w postaci zbioru danych, zatem tworzymy nowƒÖ ramkƒô danych.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>nowiPracownicy <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">YearsExperience=</span><span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">10</span>,<span class="dv">11</span>))</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(salary_model, nowiPracownicy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2        3 
101391.9 120291.8 129741.8 </code></pre>
</div>
</div>
<p>Tym sposobem uzyskujemy nastƒôpujƒÖce wide≈Çki:</p>
<ul>
<li>pracownik o 8 latach do≈õwiadczenia - proponowana pensja 101391,9 $ +/- 5788 $</li>
<li>pracownik o 10 latach do≈õwiadczenia - proponowana pensja 120291,8 $ +/- 5788 $</li>
<li>pracownik o 11 latach do≈õwiadczenia - proponowana pensja 129741,8 $ +/- 5788 $</li>
</ul>
<p>W powy≈ºszym przyk≈Çadzie prognozowane warto≈õci pojawi≈Çy siƒô w konsoli, natomiast w sytuacji, w kt√≥rej chcieliby≈õmy wykonaƒá predykcjƒô dla bardzo wielu nowych warto≈õci to warto te prognozowane warto≈õci umie≈õciƒá od razu w zbiorze danych. Mo≈ºna to zrobiƒá w nastƒôpujƒÖcy spos√≥b:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>nowiPracownicy <span class="ot">&lt;-</span> nowiPracownicy <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">salary_pred=</span><span class="fu">predict</span>(<span class="at">object =</span> salary_model, <span class="at">newdata =</span> .))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>nowiPracownicy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  YearsExperience salary_pred
1               8    101391.9
2              10    120291.8
3              11    129741.8</code></pre>
</div>
</div>
<p>W powy≈ºszym kodzie symbol <code>.</code> oznacza analizowany zbi√≥r danych, zatem nie ma potrzeby powtarzania jego nazwy.</p>
<section id="zadanie" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="zadanie"><span class="header-section-number">3.2.1</span> Zadanie</h3>
<p>Dla danych dotyczƒÖcych <a href="data/sklep77.xlsx">sklepu nr 77</a> opracuj model zale≈ºno≈õci sprzeda≈ºy od liczby klient√≥w. Ile wynosi teoretyczna sprzeda≈º w dniach, w kt√≥rych liczba klient√≥w bƒôdzie wynosi≈Ça 560, 740, 811 oraz 999 os√≥b?</p>
</section>
</section>
<section id="regresja-wieloraka" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="regresja-wieloraka"><span class="header-section-number">3.3</span> Regresja wieloraka</h2>
<p>Og√≥lna postaƒá regresji wielorakiej jest nastƒôpujƒÖca:</p>
<p><span class="math display">\[\hat{y}_{i}=b_{1}x_{1i}+b_{2}x_{2i}+...+b_{k}x_{ki}+b_{0}\]</span></p>
<p>W tym przypadku nie wyznaczamy prostej tylko <span class="math inline">\(k\)</span>-wymiarowƒÖ przestrze≈Ñ.</p>
<p>Na podstawie danych dotyczƒÖcych <a href="data/pracownicy.xlsx">zatrudnienia</a> opracuj model, w kt√≥rym zmiennƒÖ zale≈ºnƒÖ jest bie≈ºƒÖce wynagrodzenie. Za pomocƒÖ regresji okre≈õlimy jakie cechy majƒÖ istotny wp≈Çyw na to wynagrodzenie.</p>
<p>Opis zbioru:</p>
<ul>
<li>id - kod pracownika</li>
<li>plec - p≈Çeƒá pracownika (0 - mƒô≈ºczyzna, 1 - kobieta)</li>
<li>data_urodz - data urodzenia</li>
<li>edukacja - wykszta≈Çcenie (w latach nauki)</li>
<li>kat_pracownika - grupa pracownicza (1 - specjalista, 2 - mened≈ºer, 3 - konsultant)</li>
<li>bwynagrodzenie - bie≈ºƒÖce wynagrodzenie</li>
<li>pwynagrodzenie - poczƒÖtkowe wynagrodzenie</li>
<li>staz - sta≈º pracy (w miesiƒÖcach)</li>
<li>doswiadczenie - poprzednie zatrudnienie (w miesiƒÖcach)</li>
<li>zwiazki - przynale≈ºno≈õƒá do zwiƒÖzk√≥w zawodowych (0 - nie, 1 - tak)</li>
<li>wiek - wiek (w latach)</li>
</ul>
<p>Rozpoczynamy od wczytania danych,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>pracownicy <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/pracownicy.xlsx"</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>pracownicy2 <span class="ot">&lt;-</span> pracownicy <span class="sc">%&gt;%</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(wiek)) <span class="sc">%&gt;%</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>id, <span class="sc">-</span>data_urodz) <span class="sc">%&gt;%</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">plec=</span><span class="fu">as.factor</span>(plec),</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>         <span class="at">kat_pracownika=</span><span class="fu">as.factor</span>(kat_pracownika),</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>         <span class="at">zwiazki=</span><span class="fu">as.factor</span>(zwiazki))</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pracownicy2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> plec       edukacja     kat_pracownika bwynagrodzenie   pwynagrodzenie 
 0:257   Min.   : 8.00   1:362          Min.   : 15750   Min.   : 9000  
 1:216   1st Qu.:12.00   2: 27          1st Qu.: 24000   1st Qu.:12450  
         Median :12.00   3: 84          Median : 28800   Median :15000  
         Mean   :13.49                  Mean   : 34418   Mean   :17009  
         3rd Qu.:15.00                  3rd Qu.: 37050   3rd Qu.:17490  
         Max.   :21.00                  Max.   :135000   Max.   :79980  
      staz       doswiadczenie    zwiazki      wiek      
 Min.   :63.00   Min.   :  0.00   0:369   Min.   :24.00  
 1st Qu.:72.00   1st Qu.: 19.00   1:104   1st Qu.:30.00  
 Median :81.00   Median : 55.00           Median :33.00  
 Mean   :81.14   Mean   : 95.95           Mean   :38.67  
 3rd Qu.:90.00   3rd Qu.:139.00           3rd Qu.:47.00  
 Max.   :98.00   Max.   :476.00           Max.   :66.00  </code></pre>
</div>
</div>
<p>W zmiennej wiek wystƒôpowa≈Ç brak danych, kt√≥ry zosta≈Ç usuniƒôty. Usuniƒôto tak≈ºe kolumny, kt√≥re nie przydadzƒÖ siƒô w modelowaniu. Ponadto dokonujemy przekszta≈Çcenia typu cech, kt√≥re sƒÖ jako≈õciowe (p≈Çeƒá, kat_pracownika, zwiazki) z typu liczbowego na czynnik/faktor. Taka modyfikacja powoduje, ≈ºe ta cecha bƒôdzie przez model traktowana jako zmienna dychotomiczna (zerojedynkowa). Proces trasformacji takiej cechy jest pokazany poni≈ºej.</p>
<p>Oryginalny zbi√≥r</p>
<table class="table">
<thead>
<tr class="header">
<th>id</th>
<th>stanowisko</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>specjalista</td>
</tr>
<tr class="even">
<td>2</td>
<td>mened≈ºer</td>
</tr>
<tr class="odd">
<td>3</td>
<td>specjalista</td>
</tr>
<tr class="even">
<td>4</td>
<td>konsultant</td>
</tr>
<tr class="odd">
<td>5</td>
<td>konsultant</td>
</tr>
</tbody>
</table>
<p>Zmienna zerojedynkowa</p>
<table class="table">
<thead>
<tr class="header">
<th>id</th>
<th>mened≈ºer</th>
<th>konsultant</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>2</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="odd">
<td>3</td>
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>4</td>
<td>0</td>
<td>1</td>
</tr>
<tr class="odd">
<td>5</td>
<td>0</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>W modelu zmienna zale≈ºna to <code>bwynagrodzenie</code>, natomiast jako zmienne niezale≈ºne bierzemy pod uwagƒô wszystkie pozosta≈Çe cechy. W celu unikniƒôcia notacji naukowej w uzyskiwanych wynikach dodajemy opcjƒô <code>options(scipen = 5)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">scipen =</span> <span class="dv">5</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(bwynagrodzenie <span class="sc">~</span> ., pracownicy2)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bwynagrodzenie ~ ., data = pracownicy2)

Residuals:
   Min     1Q Median     3Q    Max 
-23185  -3041   -705   2591  46295 

Coefficients:
                   Estimate  Std. Error t value Pr(&gt;|t|)    
(Intercept)     -4764.87418  3590.49652  -1.327  0.18514    
plec1           -1702.43743   796.51779  -2.137  0.03309 *  
edukacja          482.43603   160.83977   2.999  0.00285 ** 
kat_pracownika2  6643.17910  1638.06138   4.056 5.87e-05 ***
kat_pracownika3 11169.64519  1372.73990   8.137 3.77e-15 ***
pwynagrodzenie      1.34021     0.07317  18.315  &lt; 2e-16 ***
staz              154.50876    31.65933   4.880 1.46e-06 ***
doswiadczenie     -15.77375     5.78369  -2.727  0.00663 ** 
zwiazki1        -1011.55276   787.80884  -1.284  0.19978    
wiek              -64.78787    47.88015  -1.353  0.17668    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6809 on 463 degrees of freedom
Multiple R-squared:  0.8444,    Adjusted R-squared:  0.8414 
F-statistic: 279.1 on 9 and 463 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Tak zbudowany model wyja≈õnia 84,4% zmienno≈õci bie≈ºƒÖcego wynagrodzenia, ale nie wszystkie zmienne sƒÖ w tym modelu istotne.</p>
<p>Parametry regresji majƒÖ nastƒôpujƒÖce interpretacje:</p>
<ul>
<li>plec1 - kobiety zarabiajƒÖ przeciƒôtnie o 1702,44 z≈Ç mniej ni≈º mƒô≈ºczy≈∫ni,</li>
<li>edukacja - wzrost liczby lat nauki o rok powoduje ≈õredni wzrost bie≈ºƒÖcego wynagrodzenia o 482,44 z≈Ç</li>
<li>kat_pracownika2 - pracownicy o kodzie 2 (mened≈ºer) zarabiajƒÖ ≈õrednio o 6643,18 z≈Ç wiƒôcej ni≈º pracownik o kodzie 1 (specjalista)</li>
<li>kat_pracownika2 - pracownicy o kodzie 3 (konsultant) zarabiajƒÖ ≈õrednio o 11169,65 z≈Ç wiƒôcej ni≈º pracownik o kodzie 1 (specjalista)</li>
<li>pwynagrodzenie - wzrost poczƒÖtkowego wynagrodzenia o 1 z≈Ç powoduje przeciƒôtny wzrost bie≈ºƒÖcego wynagrodzenia o 1,34 z≈Ç</li>
<li>staz - wzrost sta≈ºu pracy o miesiƒÖc skutkuje przeciƒôtnym wzrostem bie≈ºƒÖcego wynagrodzenia o 154,51 z≈Ç</li>
<li>doswiadcznie - wzrost do≈õwiadczenia o miesiƒÖc powoduje ≈õredni spadek bie≈ºƒÖcego wynagrodzenia o 15,77 z≈Ç</li>
<li>zwiazki1 - pracownicy nale≈ºƒÖcy do zwiƒÖzk√≥w zawodowych zarabiajƒÖ ≈õrednio o 1011,55 z≈Ç mniej ani≈ºeli pracownicy, kt√≥rzy do zwiƒÖzk√≥w nie zale≈ºƒÖ</li>
<li>wiek - wzrost wieku pracownika o 1 rok to przeciƒôtnym spadek bie≈ºƒÖcego wynagrodzenia o 64,79 z≈Ç</li>
</ul>
<p>Wszystkie te interpretacje obowiƒÖzujƒÖ przy za≈Ço≈ºeniu <em>ceteris paribus</em> - przy pozosta≈Çych warunkach niezmienionych.</p>
<p>Ten model wymaga oczywi≈õcie ulepszenia do czego wykorzystamy pakiet <a href="https://cran.r-project.org/web/packages/olsrr/index.html">olsrr</a>.</p>
<p>PierwszƒÖ kwestiƒÖ, kt√≥rƒÖ siƒô zajmiemy jest wsp√≥≈Çliniowo≈õƒá zmiennych. W regresji zmienne obja≈õniajƒÖce powinny byƒá jak najbardziej skorelowane ze zmiennƒÖ obja≈õnianƒÖ, a mo≈ºliwie nieskorelowane ze sobƒÖ. W zwiƒÖzku z tym wybieramy ze zbioru wy≈ÇƒÖcznie cechy ilo≈õciowe, dla kt√≥rym wyznaczymy wsp√≥≈Çczynnik korelacji liniowej Pearsona. Do wizualizacji tych warto≈õci wykorzystamy pakiet <a href="https://cran.r-project.org/web/packages/corrplot/">corrplot</a> s≈Çu≈ºƒÖcy do wizualizacji wsp√≥≈Çczynnika korelacji.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(olsrr)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>korelacje <span class="ot">&lt;-</span> pracownicy2 <span class="sc">%&gt;%</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(plec, kat_pracownika, zwiazki)) <span class="sc">%&gt;%</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cor</span>()</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(korelacje, <span class="at">method =</span> <span class="st">"number"</span>, <span class="at">type =</span> <span class="st">"upper"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-regresja_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Mo≈ºemy zauwa≈ºyƒá, ≈ºe warto≈õci bie≈ºƒÖcego wynagrodzenia sƒÖ najsilniej skorelowane w warto≈õciami wynagrodzenia poczƒÖtkowego. Tak≈ºe do≈õwiadczenie i wiek sƒÖ silnie ze sobƒÖ zwiƒÖzane, co mo≈ºe sugerowaƒá, ≈ºe obie zmienne wnoszƒÖ do modelu podobnƒÖ informacjƒô.</p>
<p>W zwiƒÖzku z tym powinni≈õmy wyeliminowaƒá niekt√≥re zmienne z modelu pozostawiajƒÖc te najwa≈ºniejsze. Wyr√≥≈ºnia siƒô trzy podej≈õcia do tego zagadnienia:</p>
<ul>
<li>ekspercki dob√≥r cech,</li>
<li>budowa wszystkich mo≈ºliwych modeli i wyb√≥r najlepszego wed≈Çug okre≈õlonego kryterium,</li>
<li>regresja krokowa.</li>
</ul>
<p>W przypadku budowy wszystkich mo≈ºliwych modeli nale≈ºy pamiƒôtaƒá o rosnƒÖcej wyk≈Çadniczo liczbie modeli: <span class="math inline">\(2^p-1\)</span>, gdzie <span class="math inline">\(p\)</span> oznacza liczbƒô zmiennych obja≈õniajƒÖcych. w rozwa≈ºanym przypadku liczba modeli wynosi 255.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>wszystkie_modele <span class="ot">&lt;-</span> <span class="fu">ols_step_all_possible</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>W uzyskanym zbiorze danych sƒÖ informacje o numerze modelu, liczbie u≈ºytych zmiennych, nazwie tych zmiennych oraz wiele miar jako≈õci. Te, kt√≥re warto wziƒÖƒá pod uwagƒô to przede wszystkim:</p>
<ul>
<li><code>rsquare</code> - wsp√≥≈Çczynnik R-kwadrat,</li>
<li><code>aic</code> - kryterium informacyjne Akaike,</li>
<li><code>msep</code> - b≈ÇƒÖd ≈õredniokwadratowy predykcji.</li>
</ul>
<p>Najwy≈ºsza warto≈õƒá wsp√≥≈Çczynnika <span class="math inline">\(R^2\)</span> zwiƒÖzana jest z modelem zawierajƒÖcym wszystkie dostƒôpne zmienne obja≈õniajƒÖce. Jest to pewna niedoskona≈Ço≈õƒá tej miary, kt√≥ra ro≈õnie wraz z liczbƒÖ zmiennych w modelu, nawet je≈õli te zmienne nie sƒÖ istotne.</p>
<p>W przypadku kryteri√≥w informacyjnych oraz b≈Çƒôdu ≈õredniokwadratowego interesujƒÖ nas jak najmniejsze warto≈õci. W√≥wczas jako najlepszy nale≈ºy wskazaƒá model nr 219 zawierajƒÖcy 6 zmiennych obja≈õniajƒÖcych.</p>
<p>MetodƒÖ, kt√≥ra tak≈ºe pozwoli uzyskaƒá optymalny model, ale przy mniejszym obciƒÖ≈ºeniu obliczeniowym jest regresja krokowa polegajƒÖca na krokowym budowaniu modelu.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_step_both_aic</span>(model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
                                           Stepwise Summary                                            
-----------------------------------------------------------------------------------------------------
Variable           Method       AIC             RSS               Sum Sq          R-Sq      Adj. R-Sq 
-----------------------------------------------------------------------------------------------------
pwynagrodzenie    addition    9862.260    31053506813.535    106862706669.340    0.77484      0.77436 
kat_pracownika    addition    9786.152    26215474648.689    111700738834.186    0.80992      0.80870 
doswiadczenie     addition    9743.487    23853248017.651    114062965465.224    0.82705      0.82557 
staz              addition    9719.469    22576592070.620    115339621412.255    0.83630      0.83455 
edukacja          addition    9707.338    21912088629.084    116004124853.791    0.84112      0.83907 
plec              addition    9703.188    21629051655.016    116287161827.859    0.84317      0.84081 
-----------------------------------------------------------------------------------------------------</code></pre>
</div>
</div>
<p>Otrzymany w ten spos√≥b model jest to≈ºsamy z modelem charakteryzujƒÖcym siƒô najlepszymi miarami jako≈õci spo≈õr√≥d zbioru wszystkich mo≈ºliwych modeli:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>wybrany_model <span class="ot">&lt;-</span> <span class="fu">lm</span>(bwynagrodzenie <span class="sc">~</span> pwynagrodzenie <span class="sc">+</span> kat_pracownika <span class="sc">+</span> doswiadczenie <span class="sc">+</span> staz <span class="sc">+</span> plec <span class="sc">+</span> edukacja, <span class="at">data =</span> pracownicy2)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wybrany_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bwynagrodzenie ~ pwynagrodzenie + kat_pracownika + 
    doswiadczenie + staz + plec + edukacja, data = pracownicy2)

Residuals:
   Min     1Q Median     3Q    Max 
-22922  -3300   -673   2537  46524 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     -6547.147   3402.860  -1.924  0.05496 .  
pwynagrodzenie      1.342      0.073  18.382  &lt; 2e-16 ***
kat_pracownika2  6734.992   1631.122   4.129 4.32e-05 ***
kat_pracownika3 11226.635   1368.413   8.204 2.30e-15 ***
doswiadczenie     -22.302      3.571  -6.246 9.51e-10 ***
staz              147.865     31.461   4.700 3.43e-06 ***
plec1           -1878.949    761.703  -2.467  0.01399 *  
edukacja          501.391    160.270   3.128  0.00187 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6820 on 465 degrees of freedom
Multiple R-squared:  0.8432,    Adjusted R-squared:  0.8408 
F-statistic: 357.1 on 7 and 465 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Uzyskany model charakteryzuje siƒô nieznacznie wiƒôkszym b≈Çƒôdem resztowym od modelu ze wszystkimi zmiennymi, ale wszystkie zmienne sƒÖ istotne. Wyraz wolny <code>(Intercept)</code> nie musi byƒá istotny w modelu.</p>
<p>Wr√≥ƒámy jeszcze na chwilƒô do tematu wsp√≥≈Çliniowo≈õci zmiennych obja≈õniajƒÖcych:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_vif_tol</span>(wybrany_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>        Variables Tolerance      VIF
1  pwynagrodzenie 0.2979792 3.355939
2 kat_pracownika2 0.6867111 1.456217
3 kat_pracownika3 0.3595692 2.781106
4   doswiadczenie 0.7054176 1.417600
5            staz 0.9862198 1.013973
6           plec1 0.6831049 1.463904
7        edukacja 0.4607529 2.170361</code></pre>
</div>
</div>
<p>Wsp√≥≈Çczynnik tolerancji wskazuje na procent niewyja≈õnionej zmienno≈õci danej zmiennej przez pozosta≈Çe zmienne obja≈õniajƒÖce. Przyk≈Çadowo wsp√≥≈Çczynnik tolerancji dla poczƒÖtkowego wynagrodzenia wynosi 0,2980, co oznacza, ≈ºe 30% zmienno≈õci poczƒÖtkowego wynagrodzenia nie jest wyja≈õnione przez pozosta≈Çe zmienne w modelu. Z kolei wsp√≥≈Çczynnik VIF jest obliczany na podstawie warto≈õci wsp√≥≈Çczynnika tolerancji i wskazuje o ile wariancja szacowanego wsp√≥≈Çczynnika regresji jest podwy≈ºszona z powodu wsp√≥≈Çliniowo≈õci danej zmiennej obja≈õniajƒÖcej z pozosta≈Çymi zmiennymi obja≈õniajƒÖcymi. Warto≈õƒá wsp√≥≈Çczynnika VIF powy≈ºej 4 nale≈ºy uznaƒá za wskazujƒÖcƒÖ na wsp√≥≈Çliniowo≈õƒá. W analizowanym przypadku takie zmienne nie wystƒôpujƒÖ.</p>
<p>Ocena si≈Çy wp≈Çywu poszczeg√≥lnych zmiennych obja≈õniajƒÖcych na zmiennƒÖ obja≈õnianƒÖ w oryginalnej postaci modelu nie jest mo≈ºliwa. Nale≈ºy wyznaczyƒá standaryzowane wsp√≥≈Çczynniki beta, kt√≥re wyliczane sƒÖ na danych standaryzowanych, czyli takich, kt√≥re sƒÖ pozbawione jednostek i cechujƒÖ siƒô ≈õredniƒÖ r√≥wnƒÖ 0, a odchyleniem standardowym r√≥wnym 1. Standaryzacja ma sens tylko dla cech numerycznych, w zwiƒÖzku z czym korzystamy z funkcji <code>mutate_if()</code>, kt√≥ra jako pierwszy argument przyjmuje warunek, kt√≥ry ma byƒá spe≈Çniony, aby by≈Ça zastosowane przekszta≈Çcenie podawane jako drugi argument.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>pracownicy2_std <span class="ot">&lt;-</span> pracownicy2 <span class="sc">%&gt;%</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate_if</span>(is.numeric, scale)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>wybrany_model_std <span class="ot">&lt;-</span> <span class="fu">lm</span>(bwynagrodzenie <span class="sc">~</span> pwynagrodzenie <span class="sc">+</span> kat_pracownika <span class="sc">+</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>                          doswiadczenie <span class="sc">+</span> staz <span class="sc">+</span> plec <span class="sc">+</span> edukacja, <span class="at">data =</span> pracownicy2_std)</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wybrany_model_std)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bwynagrodzenie ~ pwynagrodzenie + kat_pracownika + 
    doswiadczenie + staz + plec + edukacja, data = pracownicy2_std)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.34098 -0.19306 -0.03939  0.14841  2.72171 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     -0.08893    0.03144  -2.828  0.00488 ** 
pwynagrodzenie   0.61842    0.03364  18.382  &lt; 2e-16 ***
kat_pracownika2  0.39400    0.09542   4.129 4.32e-05 ***
kat_pracownika3  0.65677    0.08005   8.204 2.30e-15 ***
doswiadczenie   -0.13657    0.02187  -6.246 9.51e-10 ***
staz             0.08691    0.01849   4.700 3.43e-06 ***
plec1           -0.10992    0.04456  -2.467  0.01399 *  
edukacja         0.08464    0.02706   3.128  0.00187 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.399 on 465 degrees of freedom
Multiple R-squared:  0.8432,    Adjusted R-squared:  0.8408 
F-statistic: 357.1 on 7 and 465 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Spo≈õr√≥d cech ilo≈õciowych najwiƒôkszy wp≈Çyw na zmiennƒÖ obja≈õnianƒÖ majƒÖ warto≈õci wynagrodzenia poczƒÖtkowego, sta≈º, edukacja i na ko≈Ñcu do≈õwiadczenie.</p>
<p>Reszty czyli r√≥≈ºnice pomiƒôdzy obserwowanymi warto≈õciami zmiennej obja≈õnianej, a warto≈õciami wynikajƒÖcymi z modelu w klasycznej metodzie najmniejszych kwadrat√≥w powinny byƒá zbli≈ºone do rozk≈Çadu normalnego. Oznacza to, ≈ºe najwiƒôcej reszt powinno skupiaƒá siƒô wok√≥≈Ç zerowych r√≥≈ºnic, natomiast jak najmniej powinno byƒá warto≈õci modelowych znacznie r√≥≈ºniƒÖcych siƒô od tych rzeczywistych.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_hist</span>(wybrany_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-regresja_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Reszty w naszym modelu wydajƒÖ siƒô byƒá zbli≈ºone do rozk≈Çadu normalnego. JednoznacznƒÖ odpowied≈∫ da jednak odpowiedni test.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_normality</span>(wybrany_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-----------------------------------------------
       Test             Statistic       pvalue  
-----------------------------------------------
Shapiro-Wilk              0.868          0.0000 
Kolmogorov-Smirnov        0.1092         0.0000 
Cramer-von Mises         42.5504         0.0000 
Anderson-Darling         13.0233         0.0000 
-----------------------------------------------</code></pre>
</div>
</div>
<p>Hipoteza zerowa w tych testach m√≥wi o zgodno≈õci rozk≈Çadu reszt z rozk≈Çadem normalnym. Na podstawie warto≈õci p, kt√≥re sƒÖ mniejsze od <span class="math inline">\(\alpha=0,05\)</span> stwierdzamy, ≈ºe sƒÖ podstawy do odrzucenia tej hipotezy czyli reszty z naszego modelu nie majƒÖ rozk≈Çadu normalnego. W diagnostyce przyczyn takiego stanu rzeczy pomo≈ºe nam wykres kwantyl-kwantyl:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_qq</span>(wybrany_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-regresja_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Gdyby wszystkie punkty le≈ºa≈Çy na prostej to oznacza≈Çoby to normalno≈õƒá rozk≈Çadu reszt. Tymczasem po lewej i prawej stronie tego wykresu znajdujƒÖ siƒô potencjalne warto≈õci odstajƒÖce, kt√≥re znacznie wp≈ÇywajƒÖ na rozk≈Çad reszt modelu.</p>
<p>Warto≈õci odstajƒÖce mo≈ºna ustaliƒá na podstawie wielu kryteri√≥w. Do jednych z najbardziej popularnych nale≈ºy odleg≈Ço≈õƒá Cooka:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>cook <span class="ot">&lt;-</span> <span class="fu">ols_plot_cooksd_bar</span>(wybrany_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-regresja_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Przypisanie tej funkcji do obiektu zwraca nam tabelƒô z numerami zidentyfikowanych obserwacji wp≈Çywowych. W przypadku odleg≈Ço≈õci Cooka jest to 35 obserwacji. Granica przynale≈ºno≈õci do grupy warto≈õci odstajƒÖcych jest wyznaczana wed≈Çug wzoru: <span class="math inline">\(4/n\)</span>, gdzie <span class="math inline">\(n\)</span> to liczba wszystkich obserwacji.</p>
<p>InnƒÖ miarƒÖ sƒÖ reszty studentyzowane.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>stud3 <span class="ot">&lt;-</span> <span class="fu">ols_plot_resid_stud</span>(wybrany_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-regresja_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Wy≈ºej wykorzystana funkcja jako kryterium odstawania przyjmuje warto≈õƒá 3 identyfikujƒÖc 10 obserwacji wp≈Çywowych. Z kolei dodanie do powy≈ºszej funkcji przyrostka <em>fit</em> powoduje przyjƒôcie jako granicy warto≈õci r√≥wnej 2.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>stud2 <span class="ot">&lt;-</span> <span class="fu">ols_plot_resid_stud_fit</span>(wybrany_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-regresja_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>W ten spos√≥b zosta≈Ço zidentyfikowanych 22 obserwacji odstajƒÖcych. KorzystajƒÖc z odleg≈Ço≈õci Cooka wyeliminujemy obserwacje odstajƒÖce ze zbioru:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> cook<span class="sc">$</span>data<span class="sc">$</span>obs[cook<span class="sc">$</span>data<span class="sc">$</span>color <span class="sc">==</span> <span class="st">"outlier"</span>]</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>pracownicy_out <span class="ot">&lt;-</span> pracownicy2[<span class="sc">-</span>outliers,]</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>wybrany_model_out <span class="ot">&lt;-</span> <span class="fu">lm</span>(bwynagrodzenie <span class="sc">~</span> pwynagrodzenie <span class="sc">+</span> kat_pracownika <span class="sc">+</span> doswiadczenie <span class="sc">+</span> staz <span class="sc">+</span> plec <span class="sc">+</span> edukacja, </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                        <span class="at">data =</span> pracownicy_out)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wybrany_model_out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = bwynagrodzenie ~ pwynagrodzenie + kat_pracownika + 
    doswiadczenie + staz + plec + edukacja, data = pracownicy_out)

Residuals:
     Min       1Q   Median       3Q      Max 
-12591.2  -2696.4   -564.8   2263.0  14704.1 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     -3756.8288  2381.5361  -1.577 0.115420    
pwynagrodzenie      1.3696     0.0676  20.260  &lt; 2e-16 ***
kat_pracownika2  6480.6971  1049.9539   6.172 1.56e-09 ***
kat_pracownika3  9791.5000  1059.4980   9.242  &lt; 2e-16 ***
doswiadczenie     -18.5808     2.3229  -7.999 1.17e-14 ***
staz              116.3809    20.9704   5.550 5.01e-08 ***
plec1           -1616.6030   505.1391  -3.200 0.001475 ** 
edukacja          397.7652   105.8146   3.759 0.000194 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 4271 on 430 degrees of freedom
Multiple R-squared:  0.894, Adjusted R-squared:  0.8923 
F-statistic: 518.3 on 7 and 430 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Model dopasowany na takim zbiorze charakteryzuje siƒô du≈ºo mniejszym b≈Çƒôdem standardowym oraz wy≈ºszym wsp√≥≈Çczynnikiem <span class="math inline">\(R^2\)</span> w por√≥wnaniu do poprzedniego. Sprawd≈∫my w takim razie normalno≈õƒá reszt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_qq</span>(wybrany_model_out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="03-regresja_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Wykres kwantyl-kwantyl wyglƒÖda ju≈º du≈ºo lepiej i w zasadzie nie obserwuje tu siƒô du≈ºych odstƒôpstw od rozk≈Çadu normalnego. Przeprowad≈∫my jeszcze odpowiednie testy statystyczne.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_test_normality</span>(wybrany_model_out)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>-----------------------------------------------
       Test             Statistic       pvalue  
-----------------------------------------------
Shapiro-Wilk              0.9696         0.0000 
Kolmogorov-Smirnov        0.0667         0.0405 
Cramer-von Mises         38.1644         0.0000 
Anderson-Darling          3.5421         0.0000 
-----------------------------------------------</code></pre>
</div>
</div>
<p>Tylko test Ko≈Çmogorova-Smirnova na poziomie istotno≈õci <span class="math inline">\(\alpha=0,01\)</span> wskaza≈Ç na brak podstaw do odrzucenia hipotezy zerowej.</p>
<section id="zadanie-1" class="level3" data-number="3.3.1">
<h3 data-number="3.3.1" class="anchored" data-anchor-id="zadanie-1"><span class="header-section-number">3.3.1</span> Zadanie</h3>
<p>Na podstawie zbioru dotyczƒÖcego <a href="data/startups.xlsx">50 startup√≥w</a> okre≈õl jakie czynniki wp≈ÇywajƒÖ na przych√≥d startup√≥w.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>startupy <span class="ot">&lt;-</span> <span class="fu">read_xlsx</span>(<span class="st">"data/startups.xlsx"</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>startupy <span class="ot">&lt;-</span> janitor<span class="sc">::</span><span class="fu">clean_names</span>(startupy)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(startupy)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   r_d_spend      administration   marketing_spend     state          
 Min.   :     0   Min.   : 51283   Min.   :     0   Length:50         
 1st Qu.: 39936   1st Qu.:103731   1st Qu.:129300   Class :character  
 Median : 73051   Median :122700   Median :212716   Mode  :character  
 Mean   : 73722   Mean   :121345   Mean   :211025                     
 3rd Qu.:101603   3rd Qu.:144842   3rd Qu.:299469                     
 Max.   :165349   Max.   :182646   Max.   :471784                     
     profit      
 Min.   : 14681  
 1st Qu.: 90139  
 Median :107978  
 Mean   :112013  
 3rd Qu.:139766  
 Max.   :192262  </code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-testy.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Testowanie hipotez</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-grupowanie.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Grupowanie</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>